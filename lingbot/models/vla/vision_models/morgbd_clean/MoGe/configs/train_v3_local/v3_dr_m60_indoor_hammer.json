{
  "data": {
      "aspect_ratio_range": [0.5, 2.0],
      "area_range": [250000, 1000000],
      "clamp_max_depth": 1000.0,
      "center_augmentation": 0.5,
      "fov_range_absolute": [1, 179],
      "fov_range_relative": [0.01, 1.0],
      "image_augmentation": ["jittering", "jpeg_loss", "blurring"],
      "mask_depth_on": true,
      "mask_max_ratio": 0.5,
      "mask_max_num": 15,
      "mask_min_num": 5,
      "min_mask_size_lb": 10,
      "max_mask_size_lb": 40,
      "noise_depth_on": true,
      "datasets": [
        {
            "name": "hammer",
            "path": "/data0/tanbin/MonocularDataCollections/all/hammer2",
            "label_type": "sfm",
            "index": ".index.txt",
            "depth": "depth.png",
            "depth_raw": "depth_raw.png",
            "weight": 5.0,
            "center_augmentation": 0.25,
            "fov_range_absolute": [30, 150],
            "fov_range_relative": [0.5, 1.0],
            "image_augmentation": ["jittering", "jpeg_loss", "blurring", "shot_noise"],
            "depth_unit": 1.0,
            "clamp_max_depth": 50.0
        }
      ]
  },
  "model_version": "v3_dr",
  "model": {
      "encoder": {
          "backbone": "dinov2_vitl14", 
          "intermediate_layers": [5, 11, 17, 23], 
          "dim_out": 1024,
          "in_chans": 3,
          "strict": false,
          "ignore_layers": [],
          "depth_mask_emb_mode": "conv_depth_1c-cat",
          "mask_ratio": 0.6
      },
      "neck": {
          "dim_in": [1026, 2, 2, 2, 2], 
          "dim_out": null, 
          "dim_res_blocks": [1024, 256, 128, 64, 32], 
          "num_res_blocks": [0, 2, 2, 2, 0], 
          "res_block_in_norm": "none", 
          "res_block_hidden_norm": "none", 
          "resamplers": ["conv_transpose", "conv_transpose", "conv_transpose", "bilinear"]
      },
      "points_head": {
          "dim_in": [1024, 256, 128, 64, 32], 
          "dim_out": [null, null, null, null, 3], 
          "dim_res_blocks": [1024, 256, 128, 64, 32], 
          "num_res_blocks": [0, 1, 1, 1, 0], 
          "res_block_in_norm": "none", 
          "res_block_hidden_norm": "none", 
          "resamplers": ["conv_transpose", "conv_transpose", "conv_transpose", "bilinear"]
      },
      "depth_head": {
          "dim_in": [1024, 256, 128, 64, 32], 
          "dim_out": [null, null, null, null, 1], 
          "dim_res_blocks": [1024, 256, 128, 64, 32], 
          "num_res_blocks": [0, 1, 1, 1, 0], 
          "res_block_in_norm": "none", 
          "res_block_hidden_norm": "none", 
          "resamplers": ["conv_transpose", "conv_transpose", "conv_transpose", "bilinear"]
      },
      "normal_head": {
          "dim_in": [1024, 256, 128, 64, 32], 
          "dim_out": [null, null, null, null, 3], 
          "dim_res_blocks": [1024, 256, 128, 64, 32], 
          "num_res_blocks": [0, 1, 1, 1, 0], 
          "res_block_in_norm": "none", 
          "res_block_hidden_norm": "none", 
          "resamplers": ["conv_transpose", "conv_transpose", "conv_transpose", "bilinear"]
      },
      "mask_head": {
          "dim_in": [1024, 256, 128, 64, 32], 
          "dim_out": [null, null, null, null, 1], 
          "dim_res_blocks": [1024, 256, 128, 64, 32], 
          "num_res_blocks": [0, 1, 1, 1, 0], 
          "res_block_in_norm": "none", 
          "res_block_hidden_norm": "none", 
          "resamplers": ["conv_transpose", "conv_transpose", "conv_transpose", "bilinear"]
      },
      "scale_head": {
          "dims": [1024, 1024, 1024, 1]
      },
      "remap_output": "exp", 
      "num_tokens_range": [1200, 3600]
  },
  "optimizer": {
      "type": "AdamW",
      "params": [
          {"params": {"include": ["*"], "exclude": ["*backbone.*"]}, "lr": 1e-4},
          {"params": {"include": ["*backbone.*"]}, "lr": 1e-5}
      ]
  },
  "lr_scheduler": {
      "type": "SequentialLR",
      "params": {
          "schedulers": [
              {"type": "LambdaLR", "params": {"lr_lambda": ["1.0", "max(0.0, min(1.0, (epoch - 1000) / 1000))"]}},
              {"type": "StepLR", "params": {"step_size": 25000, "gamma": 0.5}}
          ],
          "milestones": [2000]
      }
  },
  "low_resolution_training_steps": 50000,
  "loss": {
      "invalid": {},
      "synthetic": {
          "global": {"function": "affine_invariant_global_loss", "weight": 1.0, "params": {"align_resolution": 32}},
          "patch_4": {"function": "affine_invariant_local_loss", "weight": 1.0, "params": {"level": 4, "align_resolution": 16, "num_patches": 16}},
          "patch_16": {"function": "affine_invariant_local_loss", "weight": 1.0, "params": {"level": 16, "align_resolution": 8, "num_patches": 256}},
          "patch_64": {"function": "affine_invariant_local_loss", "weight": 1.0, "params": {"level": 64, "align_resolution": 4, "num_patches": 4096}},
          "normal": {"function": "normal_loss", "weight": 1.0},
          "mask": {"function": "mask_l2_loss", "weight": 1.0},
          "metric_scale": {"function": "metric_scale_loss", "weight": 1.0},
          "depth": {"function": "depth_loss", "weight": 1.0}
      },
      "sfm": {
          "global": {"function": "affine_invariant_global_loss", "weight": 1.0, "params": {"align_resolution": 32}},
          "patch_4": {"function": "affine_invariant_local_loss", "weight": 1.0, "params": {"level": 4, "align_resolution": 16, "num_patches": 16}},
          "patch_16": {"function": "affine_invariant_local_loss", "weight": 1.0, "params": {"level": 16, "align_resolution": 8, "num_patches": 256}},
          "mask": {"function": "mask_l2_loss", "weight": 1.0},
          "metric_scale": {"function": "metric_scale_loss", "weight": 1.0},
          "depth": {"function": "depth_loss", "weight": 1.0}
      },
      "lidar": {
          "global": {"function": "affine_invariant_global_loss", "weight": 1.0, "params": {"align_resolution": 32}},
          "patch_4": {"function": "affine_invariant_local_loss", "weight": 1.0, "params": {"level": 4, "align_resolution": 16, "num_patches": 16}},
          "mask": {"function": "mask_l2_loss", "weight": 1.0},
          "metric_scale": {"function": "metric_scale_loss", "weight": 1.0},
          "depth": {"function": "depth_loss", "weight": 1.0}
      }
  }
}